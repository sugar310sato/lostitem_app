# エラー修正内容

## 発生したエラー

```
Line 55:
Flag "recursesubdirs" must be used if flag "createallsubdirs" is used.
```

## 原因

Inno Setupでは、`createallsubdirs`フラグを使用する場合、必ず`recursesubdirs`フラグも一緒に使用する必要があります。

## 修正内容

### 修正前
```iss
[Files]
Source: "data\backups\database\*"; DestDir: "{commonappdata}\{#MyAppName}\data\backups\database"; Flags: ignoreversion createallsubdirs skipifsourcedoesntexist
```

このコードでは、`createallsubdirs`のみが使用されており、`recursesubdirs`が含まれていませんでした。

### 修正後
```iss
[Files]
Source: "lostitem.db"; DestDir: "{commonappdata}\{#MyAppName}\data\database"; Flags: ignoreversion onlyifdoesntexist
Source: "data\config\paths.py"; DestDir: "{commonappdata}\{#MyAppName}\data\config"; Flags: ignoreversion

[Dirs]
Name: "{commonappdata}\{#MyAppName}\data"
Name: "{commonappdata}\{#MyAppName}\data\backups"
Name: "{commonappdata}\{#MyAppName}\data\backups\database"
Name: "{commonappdata}\{#MyAppName}\data\backups\images"
Name: "{commonappdata}\{#MyAppName}\data\config"
Name: "{commonappdata}\{#MyAppName}\data\database"
Name: "{commonappdata}\{#MyAppName}\data\images"
Name: "{commonappdata}\{#MyAppName}\data\images\bundle"
Name: "{commonappdata}\{#MyAppName}\data\images\main"
Name: "{commonappdata}\{#MyAppName}\data\images\sub"
Name: "{commonappdata}\{#MyAppName}\data\logs"
```

## 変更点

1. **`[Files]`セクション**: 空ディレクトリを作成しようとしていた不要な行を削除
2. **`[Dirs]`セクション**: 空のディレクトリ構造を明示的に作成する新しいセクションを追加
3. **データベース**: 既存データベースを保護するために `onlyifdoesntexist` フラグを使用

## ディレクトリ構造

修正後のインストーラーは以下のディレクトリ構造を作成します：

```
C:\ProgramData\拾得物管理システム\data\
├── backups\
│   ├── database\
│   └── images\
├── config\
│   └── paths.py
├── database\
│   └── lostitem.db（初期化済み）
├── images\
│   ├── bundle\
│   ├── main\
│   └── sub\
└── logs\
```

## 次のステップ

1. Inno Setupで再度ビルドを実行してください
2. インストーラーをテストしてください
3. 必要に応じて追加の設定を行ってください

